<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trade Quest - Trading Simulator</title>
    <link rel="stylesheet" href="style.css">

    <!-- Amazon Cognito Identity SDK -->
    <script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@6.3.6/dist/amazon-cognito-identity.min.js"></script>
</head>
<body>
    <!-- Authentication Container -->
    <div id="auth-container" class="auth-container">
        <div class="auth-box">
            <h1>Trade Quest</h1>
            <p class="subtitle">Cloud-Native Trading Simulator</p>

            <!-- Sign In Form -->
            <div id="signin-form" class="auth-form">
                <h2>Sign In</h2>
                <input type="email" id="signin-email" placeholder="Email" autocomplete="email">
                <input type="password" id="signin-password" placeholder="Password" autocomplete="current-password">
                <button onclick="handleSignIn()" class="auth-btn">Sign In</button>
                <p class="auth-message" id="signin-message"></p>
                <p class="auth-link">Don't have an account? <a href="#" onclick="showSignUpForm(); return false;">Sign Up</a></p>
                <p class="auth-link"><a href="#" onclick="showForgotPasswordForm(); return false;">Forgot Password?</a></p>
            </div>

            <!-- Sign Up Form -->
            <div id="signup-form" class="auth-form" style="display: none;">
                <h2>Sign Up</h2>
                <p style="text-align: center; color: #666; margin-bottom: 10px;">Start with $100,000 to trade!</p>
                <input type="email" id="signup-email" placeholder="Email" autocomplete="email">
                <input type="password" id="signup-password" placeholder="Password (min 8 chars)" autocomplete="new-password">
                <input type="password" id="signup-confirm-password" placeholder="Confirm Password" autocomplete="new-password">
                <button onclick="handleSignUp()" class="auth-btn">Sign Up</button>
                <p class="auth-message" id="signup-message"></p>
                <p class="auth-link">Already have an account? <a href="#" onclick="showSignInForm(); return false;">Sign In</a></p>
            </div>

            <!-- Verification Form -->
            <div id="verification-form" class="auth-form" style="display: none;">
                <h2>Verify Email</h2>
                <p>A verification code has been sent to your email.</p>
                <input type="text" id="verification-code" placeholder="Verification Code">
                <button onclick="handleVerification()" class="auth-btn">Verify</button>
                <p class="auth-message" id="verification-message"></p>
                <p class="auth-link"><a href="#" onclick="resendVerificationCode(); return false;">Resend Code</a></p>
                <p class="auth-link"><a href="#" onclick="showSignInForm(); return false;">Back to Sign In</a></p>
            </div>

            <!-- Forgot Password Form -->
            <div id="forgot-password-form" class="auth-form" style="display: none;">
                <h2>Reset Password</h2>
                <input type="email" id="forgot-email" placeholder="Email" autocomplete="email">
                <button onclick="handleForgotPassword()" class="auth-btn">Send Reset Code</button>
                <p class="auth-message" id="forgot-message"></p>
                <p class="auth-link"><a href="#" onclick="showSignInForm(); return false;">Back to Sign In</a></p>
            </div>

            <!-- Reset Password Form -->
            <div id="reset-password-form" class="auth-form" style="display: none;">
                <h2>Reset Password</h2>
                <p>Enter the verification code sent to your email.</p>
                <input type="text" id="reset-code" placeholder="Verification Code">
                <input type="password" id="reset-password" placeholder="New Password" autocomplete="new-password">
                <input type="password" id="reset-confirm-password" placeholder="Confirm New Password" autocomplete="new-password">
                <button onclick="handleResetPassword()" class="auth-btn">Reset Password</button>
                <p class="auth-message" id="reset-message"></p>
                <p class="auth-link"><a href="#" onclick="showSignInForm(); return false;">Back to Sign In</a></p>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="container" style="display: none;">
        <!-- Header -->
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <div>
                    <h1>Trade Quest</h1>
                    <p class="subtitle">Cloud-Native Trading Simulator</p>
                </div>
                <div class="user-menu">
                    <span id="user-email-display" class="user-email"></span>
                    <button onclick="authManager.signOut()" class="signout-btn">Sign Out</button>
                </div>
            </div>
        </header>

        <!-- User Info Section -->
        <section class="user-info">
            <div class="balance-display">
                <div class="balance-item">
                    <span class="label">Cash Balance:</span>
                    <span id="balance" class="value">$0.00</span>
                </div>
                <div class="balance-item">
                    <span class="label">Portfolio Value:</span>
                    <span id="portfolio-value" class="value">$0.00</span>
                </div>
                <div class="balance-item">
                    <span class="label">Total Value:</span>
                    <span id="total-value" class="value">$0.00</span>
                </div>
                <div class="balance-item">
                    <span class="label">P/L:</span>
                    <span id="profit-loss" class="value">$0.00</span>
                </div>
            </div>
        </section>

        <!-- Main Content Grid -->
        <div class="main-grid">
            <!-- Market Prices Section -->
            <section class="prices-section">
                <h2>Market Prices</h2>
                <div id="prices-container" class="prices-grid">
                    <p>Loading prices...</p>
                </div>
                <button onclick="refreshPrices()" class="refresh-btn">Refresh Prices</button>
            </section>

            <!-- Portfolio Section -->
            <section class="portfolio-section">
                <h2>My Portfolio</h2>
                <div id="portfolio-container">
                    <p>No positions yet</p>
                </div>
            </section>
        </div>

        <!-- News Section -->
        <section class="news-section">
            <h2>Market News</h2>
            <div id="news-container">
                <p>Loading news...</p>
            </div>
            <button onclick="refreshNews()" class="refresh-btn">Refresh News</button>
        </section>

        <!-- Leaderboard Section -->
        <section class="leaderboard-section">
            <h2>Leaderboard</h2>
            <div id="leaderboard-container">
                <p>Loading leaderboard...</p>
            </div>
            <button onclick="refreshLeaderboard()" class="refresh-btn">Refresh Leaderboard</button>
        </section>
    </div>

    <!-- Trade Modal -->
    <div id="trade-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeTradeModal()">&times;</span>
            <h2>Execute Trade</h2>
            <div class="trade-form">
                <p><strong>Asset:</strong> <span id="trade-symbol"></span></p>
                <p><strong>Current Price:</strong> $<span id="trade-price"></span></p>
                <p><strong>Available Cash:</strong> $<span id="trade-available-cash"></span></p>
                <p><strong>Holdings:</strong> <span id="trade-holdings"></span> shares</p>

                <label for="trade-quantity">Quantity:</label>
                <input type="number" id="trade-quantity" min="1" value="1">

                <div class="trade-actions">
                    <button onclick="executeTrade('buy')" class="buy-btn">BUY</button>
                    <button onclick="executeTrade('sell')" class="sell-btn">SELL</button>
                </div>

                <p id="trade-message" class="trade-message"></p>
            </div>
        </div>
    </div>

    <script src="config.js?v=3"></script>
    <script src="auth.js?v=3"></script>
    <script src="auth-ui.js?v=3"></script>
    <script src="app.js?v=3"></script>
</body>
</html>
